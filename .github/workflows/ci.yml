name: CI
on:
  push:
  pull_request:

jobs:
  lint:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4
      - name: Show PowerShell
        shell: pwsh
        run: pwsh --version
      - name: Syntax check key scripts
        shell: pwsh
        run: |
          pwsh -NoLogo -NoProfile -Command "Get-ChildItem -Recurse -Filter '*.ps1' | Select-Object -First 50 | ForEach-Object { [System.Management.Automation.Language.Parser]::ParseFile($_.FullName,[ref]$null,[ref]$null) | Out-Null }"
